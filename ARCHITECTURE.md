# 🤖 Budget Bot - Архитектура и Руководство

## 📋 Обзор проекта

**Budget Bot** - Telegram бот для управления личными финансами с интеграцией Google Sheets и AI-советником на базе DeepSeek.

### Технологический стек
- **Python 3.10+**
- **python-telegram-bot** (v20+) - библиотека для Telegram
- **gspread** + **oauth2client** - работа с Google Sheets
- **httpx** - HTTP клиент для DeepSeek API
- **python-dotenv** - управление переменными окружения

---

## 📁 Структура проекта

```
budget_bot/
├── .env                    # Секреты (НЕ коммитить в git!)
├── google_credentials.json # Ключ Google Service Account
├── requirements.txt        # Зависимости Python
├── config.py              # Конфигурация бота
├── main.py                # Точка входа
├── bot/
│   ├── __init__.py
│   ├── handlers/          # Обработчики команд
│   │   ├── __init__.py
│   │   ├── start.py       # /start, /help
│   │   ├── transactions.py # /add, быстрый ввод
│   │   ├── balance.py     # /balance, /stats
│   │   ├── advisor.py     # /advisor - AI помощник
│   │   └── settings.py    # /settings
│   ├── keyboards/         # Клавиатуры и кнопки
│   │   ├── __init__.py
│   │   └── menus.py
│   └── states.py          # Состояния диалогов
├── services/
│   ├── __init__.py
│   ├── sheets.py          # Интеграция Google Sheets
│   └── ai_advisor.py      # DeepSeek AI советник
└── utils/
    ├── __init__.py
    └── formatters.py      # Форматирование сообщений
```

---

## 🔧 Конфигурация (.env файл)

```env
# Telegram
TELEGRAM_BOT_TOKEN=ваш_токен_от_BotFather

# Google Sheets
GOOGLE_SHEETS_ID=ID_вашей_таблицы
GOOGLE_CREDENTIALS_FILE=google_credentials.json

# DeepSeek AI
DEEPSEEK_API_KEY=sk-ваш_ключ

# Настройки пользователя (Human Design)
USER_TIMEZONE=Europe/Minsk
USER_NAME=Артур
```

---

## 📊 Структура Google Sheets

### Лист "Транзакции" (куда пишет бот)
| Колонка | Название | Тип данных | Пример |
|---------|----------|------------|--------|
| A | Дата | Число (1-31) | 7 |
| B | Тип | Текст | Доход/Расход/Перевод |
| C | Счёт | Текст | Наличные |
| D | Категория | Текст | Продукты |
| E | Сумма | Число | 50 |
| F | Счёт Куда | Текст | Карта (для переводов) |
| G | Комментарий | Текст | Магазин |
| H | Полная дата | Формула | =DATE(...) |
| I | Часы | Число | 10 (для расчета зарплаты) |
| J | Часы×6.5 | Формула | =I*6.5 |

### Лист "Справочники" (читает бот)
- Типы: Доход, Расход, Перевод
- Счета: Наличные, Карта, Карта Сбер, На Аренду, Копилка Тинькофф, На доллары, Наличка в Рублях
- Категории: Зарплата/Чаевые, Подработка, Продукты, Кафе, Досуг, и т.д.

---

## 🎯 Основные функции бота

### 1. Быстрый ввод транзакции
**Формат**: `[сумма] [категория] [комментарий]`

Примеры:
- `50 продукты магазин` → Расход 50 BYN на Продукты
- `135 чаевые смена 10ч` → Доход 135 BYN, Зарплата/Чаевые, 10 часов
- `перевод 100 карта` → Перевод 100 BYN на Карту

### 2. Меню с кнопками
```
🏠 Главное меню
├── ➕ Добавить
│   ├── 💸 Расход
│   ├── 💰 Доход
│   └── 🔄 Перевод
├── 💳 Балансы
├── 📊 Статистика
├── 🤖 AI Советник
└── ⚙️ Настройки
```

### 3. AI Советник (DeepSeek)
- Анализ текущих расходов
- Сравнение с бюджетом
- Предупреждения о перерасходе
- Мотивационные сообщения (с учетом Human Design)
- Советы по оптимизации

---

## 🔄 Диаграмма потока данных

```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  Telegram   │────▶│   Budget    │────▶│   Google    │
│    User     │◀────│     Bot     │◀────│   Sheets    │
└─────────────┘     └──────┬──────┘     └─────────────┘
                          │
                          ▼
                   ┌─────────────┐
                   │  DeepSeek   │
                   │   AI API    │
                   └─────────────┘
```

---

## 📱 Сценарии использования

### Сценарий 1: Быстрый расход
```
User: 50 продукты пятерочка
Bot: ✅ Записано!
     💸 Расход: 50 BYN
     📁 Категория: Продукты
     💬 Пятерочка
     📅 07.01.2025
```

### Сценарий 2: Доход с часами
```
User: 135 чаевые смена 10ч
Bot: ✅ Записано!
     💰 Доход: 135 BYN
     📁 Категория: Зарплата/Чаевые
     ⏰ Часы: 10 (= 65 BYN по ставке)
     📅 07.01.2025
```

### Сценарий 3: AI Советник
```
User: /advisor
Bot: 🤖 Анализирую твой бюджет...
     
     📊 Текущая ситуация (январь 2025):
     • Доходы: 135 BYN
     • Расходы: 50 BYN
     • Баланс: +85 BYN
     
     ⚠️ Внимание:
     • До лимита "Продукты" осталось 450 BYN
     
     💡 Совет дня:
     Артур, как Эмоциональный Проектор, ты 
     максимально эффективен в первой половине дня.
     Запланируй основные покупки на это время!
```

---

## 🚀 Этапы разработки

### Фаза 1: MVP (1-2 дня)
- [x] Регистрация бота
- [x] Настройка Google Sheets API
- [x] Настройка DeepSeek API
- [ ] Базовый бот с командой /start
- [ ] Подключение к Google Sheets
- [ ] Запись простой транзакции

### Фаза 2: Основной функционал (2-3 дня)
- [ ] Меню с inline кнопками
- [ ] Быстрый парсинг сообщений
- [ ] Отображение балансов
- [ ] Базовая статистика

### Фаза 3: AI Советник (1-2 дня)
- [ ] Интеграция DeepSeek
- [ ] Анализ бюджета
- [ ] Персонализированные советы

### Фаза 4: Полировка (1-2 дня)
- [ ] Обработка ошибок
- [ ] Логирование
- [ ] Тестирование

---

## 🔐 Безопасность

1. **НЕ коммитить в git:**
   - `.env`
   - `google_credentials.json`

2. **Создать `.gitignore`:**
```
.env
google_credentials.json
__pycache__/
*.pyc
.venv/
```

---

## 📝 Заметки для разработки

### Human Design интеграция
Бот должен учитывать профиль Эмоционального Проектора 2/4:
- Советы о времени для важных финансовых решений
- Напоминания об отдыхе при интенсивной работе
- Мотивация через качество, а не количество
- Учет эмоциональных волн при анализе паттернов расходов

### Особенности DeepSeek
- Работает из Беларуси без VPN ✅
- Бесплатно $5 на старте
- Модель: `deepseek-chat`
- Стоимость: ~$0.0001 за запрос

---

*Документ создан: Январь 2025*
*Версия: 1.0*
